<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        #dd {
            height: 900px;
            width: 100%;
            background: darkblue ;
        }
        #cd{
            height: 600px;
            width: 100%;
            background: darkkhaki ;
        }
    </style>
</head>
<body>
<button class="btn1">获得 scrollbar top offset</button>
<div id="dd"></div>
<div id="cd">
    <canvas id="process" width="300" height="300"></canvas>
</div>
<script src="jquery-1.12.4.js"></script>
<script>
    (function (){
        var c = document.getElementById('process'),
            process = 0,
            ctx = c.getContext('2d');

        // 画灰色的圆
        ctx.beginPath();
        ctx.arc(150, 150, 85, 0, Math.PI*2);
        ctx.closePath();
        ctx.fillStyle = '#9cc';
        ctx.fill();

        function animate(){
            requestAnimationFrame(function (){
                process = process + 1;
                drawCricle(ctx, process);
                if (process <75 ) {
                    animate();
                }
            });
        }

        function drawCricle(ctx, percent){
            // 画进度环
            ctx.beginPath();
            ctx.moveTo(150, 150);
            ctx.arc(150, 150, 80, Math.PI * 2, Math.PI * (2 + 2* percent / 100 ));
            ctx.closePath();
            ctx.fillStyle = '#369';
            ctx.fill();

            // 画内填充圆
            ctx.beginPath();
            ctx.arc(150, 150, 75, 0, Math.PI * 2);
            ctx.closePath();
            ctx.fillStyle = "#fff";
            ctx.fill();

            // 填充文字
            ctx.font = "bold 20pt Microsoft YaHei";
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.moveTo(150, 150);
            ctx.fillText(process + '%', 150, 150);
        }
//        var eTop=$("#cd").offset().top;//橙色容器距离整个页面顶部的距离
//        var wTop=$(window).height();//绿色框可视区域的高度
//        window.on=function(){
//            var wTop=$(window).height();//缩放窗口这个高度会改变，需要再取得
//        };
//        $(window).scroll(function scrollT(){
//            var dTop = $(document).scrollTop();//绿色框可视区域上面到黑色页面顶部的距离，会实时改变
//            if(dTop+wTop-600>eTop){
////            alert($("#cd").offset(window).top+"px");
//            animate();
//
//            }
//
//        });
        var onMouseOverCount = 0;
        if (onMouseOverCount<1){
                var oCd = document.getElementById("cd");
                oCd.onmouseover = function () {
                    animate();
                    onMouseOverCount = onMouseOverCount+1;
                };
            }

    }()
    );



</script>

</body>
</html>